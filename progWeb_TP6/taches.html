<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Résumé des tâches</title>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@300;700&display=swap" rel="stylesheet">
  <link rel="icon" href="main-19581404.png" type="image/png">
<style>
  body {
    font-family: 'Comic Neue', cursive;
    background: radial-gradient(ellipse at top, #fceff9 0%, #ffeefc 100%);
    background-size: cover;
    background-attachment: fixed;
    color: #4d3d56;
    margin: 0;
    padding: 20px;
  }

  header {
  text-align: center;
  background: linear-gradient(to right, #ffc0cb, #ff99bb);
  color: white;
  padding: 25px;
  margin-bottom: 50px;
  border-radius: 20px 20px 0 0;
  box-shadow: 0 5px 10px #f99ac9;
}

h1 {
  font-size: 2.4em;
  color: #fff;
  margin-bottom: 10px;
  text-shadow: 1px 1px #d75c97;
}

  .filters {
    text-align: center;
    margin-bottom: 30px;
  }

  .filters select, .filters input[type="date"], .filters button {
    font-family: 'Comic Neue', cursive;
    background-color: #fff0f5;
    border: 2px dashed #ffc0cb;
    border-radius: 10px;
    padding: 8px 12px;
    margin: 5px;
    box-shadow: 2px 2px 0 #ffc0cb;
    transition: transform 0.2s;
  }

  .filters button:hover {
    transform: scale(1.05);
    background-color: #ffe4ec;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background-color: #fffafc;
    border: 3px dashed #f9c1de;
    box-shadow: 0 0 20px #fbcce7;
    border-radius: 15px;
    overflow: hidden;
  }

  th {
    background-color: #ffc0cb;
    color: #fff;
    padding: 12px;
    font-weight: bold;
    text-shadow: 1px 1px #d75c97;
  }

  td {
    padding: 10px;
    border-bottom: 1px dashed #ffccdd;
  }

  tbody tr:nth-child(odd) {
    background-color: #fff0f5;
  }

  .btn-status {
    font-family: 'Comic Neue', cursive;
    font-size: 0.9em;
    background-color: #ffe4ec;
    border: 1px solid #f99ac9;
    border-radius: 12px;
    padding: 5px 10px;
    margin: 2px;
    cursor: pointer;
    color: #d14f88;
    transition: all 0.2s;
  }

  .btn-status:hover:not(:disabled) {
    background-color: #ffc0cb;
    color: white;
    transform: scale(1.05);
  }

  .btn-status.active {
    background-color: #ff66b2;
    color: white;
    cursor: default;
    font-weight: bold;
  }

  button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  ::selection {
    background: #ffb3d1;
  }

  @media screen and (max-width: 600px) {
    table, thead, tbody, th, td, tr {
      display: block;
    }
    th {
      position: sticky;
      top: 0;
      z-index: 2;
    }
    td {
      margin-bottom: 10px;
    }
  }



  /*TEST ZONE*/
  footer {
  text-align: center;
  font-size: 0.9em;
  background: #ffc0cb;
  color: #fff;
  padding: 15px;
  border-radius: 0 0 20px 20px;
  margin-top: 60px;
  box-shadow: 0 -3px 10px #fbcce7;
}
</style>

</head>
<body>
    <header>
        <h1>Résumé des tâches enregistrées</h1>
    </header>

  <div class="filters">
    <label>Priorité :
      <select id="filterPriority">
        <option value="">Toutes</option>
      </select>
    </label>

    <label>Statut :
      <select id="filterStatus">
        <option value="">Tous</option>
        <option value="À faire">À faire</option>
        <option value="En cours">En cours</option>
        <option value="Terminée">Terminée</option>
        <option value="Annulée">Annulée</option>
      </select>
    </label>

    <button onclick="toggleTriDate()">Trier par date : <span id="triLabel">croissante</span></button>
    <button onclick="toggleShowDone()"><span id="triLabelMask">Afficher</span> les tâches terminées</button>
    <button onclick="resetFiltres()">Réinitialiser les filtres</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Titre</th>
        <th>Description</th>
        <th>Date</th>
        <th>Priorité</th>
        <th>Statut</th>
        <th>Changer statut</th>
      </tr>
    </thead>
    <tbody id="taskTableBody"></tbody>
  </table>

<footer>
    <p>&copy; 2025 Joan Jacquin. All Rights Reserved.</p>
</footer>

  <!-- Priorités -->
  <script id="priorityData" type="application/json">
    [
      { "priority": 1, "priority": "Urgent" },
      { "priority": 2, "priority": "Très important" },
      { "priority": 3, "priority": "Important" },
      { "priority": 4, "priority": "Peu important" },
      { "priority": 5, "priority": "Optionel" }
    ]
  </script>

  <script>
    const STATUSES = ["À faire", "En cours", "Terminée", "Annulée"];
    let showDoneTasks = false;
    let triAscendant = true;
    let triParDate = true;
    let priorityList = [];

    document.addEventListener("DOMContentLoaded", () => {
      priorityList = JSON.parse(document.getElementById("priorityData").textContent);
      remplirFiltresPriorite();
      afficherTaches();

      document.getElementById("filterPriority").addEventListener("change", afficherTaches);
      document.getElementById("filterStatus").addEventListener("change", afficherTaches);
    });

    function remplirFiltresPriorite() {
      const select = document.getElementById("filterPriority");
      priorityList.forEach(p => {
        const opt = document.createElement("option");
        opt.value = p.priority;
        opt.textContent = p.priority;
        select.appendChild(opt);
      });
    }

    function afficherTaches() {
      const tbody = document.getElementById("taskTableBody");
      tbody.innerHTML = "";
      let taskList = JSON.parse(localStorage.getItem("taskList") || "[]");

      const fPrio = document.getElementById("filterPriority").value;
      const fStatut = document.getElementById("filterStatus").value;

      // Appliquer filtres
      taskList = taskList.filter(task => {
        if (!showDoneTasks && task.status === "Terminée") return false;
        if (fPrio && task.priority != fPrio) return false;
        if (fStatut && task.status !== fStatut) return false;
        return true;
      });

        // Tri selon mode
        if (triParDate) {
        taskList.sort((a, b) => {
            return triAscendant
            ? a.date.localeCompare(b.date)
            : b.date.localeCompare(a.date);
        });
        } else {
        taskList.sort((a, b) => a.id - b.id);
        }


      taskList.forEach(task => {
        const prioObj = priorityList.find(p => p.priority == task.priority);
        const priorityLabel = prioObj ? prioObj.priority : "Inconnue";

        let statusButtons = "";
        STATUSES.forEach(status => {
          const isActive = task.status === status;
          statusButtons += `<button
            class="btn-status ${isActive ? 'active' : ''}"
            ${isActive ? 'disabled' : ''}
            onclick="changerStatut(${task.id}, '${status}')"
          >${status}</button>`;
        });

        const row = `
          <tr id="task-${task.id}">
            <td>${task.id}</td>
            <td>${task.title}</td>
            <td>${task.description}</td>
            <td>${task.date}</td>
            <td>${task.priority}</td>
            <td>${task.status}</td>
            <td>${statusButtons}</td>
          </tr>
        `;
        tbody.insertAdjacentHTML("beforeend", row);
      });
    }

    function changerStatut(taskId, nouveauStatut) {
      let taskList = JSON.parse(localStorage.getItem("taskList") || "[]");
      const task = taskList.find(t => t.id === taskId);
      if (!task) return;
      task.status = nouveauStatut;
      localStorage.setItem("taskList", JSON.stringify(taskList));
      afficherTaches();
    }

    function toggleShowDone() {
      showDoneTasks = !showDoneTasks;
      document.getElementById("triLabelMask").textContent = showDoneTasks ? "Masquer" : "Afficher";
      afficherTaches();
    }

    function toggleTriDate() {
        triAscendant = !triAscendant;
        triParDate = true; // On réactive le tri par date
        document.getElementById("triLabel").textContent = triAscendant ? "croissante" : "décroissante";
        afficherTaches();
    }


    function resetFiltres() {
        document.getElementById("filterPriority").value = "";
        document.getElementById("filterStatus").value = "";
        triAscendant = true;
        triParDate = false;
        showDoneTasks = false;
        document.getElementById("triLabel").textContent = "croissante";
        afficherTaches();
    }

  </script>
</body>
</html>
